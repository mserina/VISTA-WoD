<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Listado de Articulos</title>
  <link rel="stylesheet" th:href="@{/css/estilos.css}">
  <link rel="stylesheet" th:href="@{https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css}">
  <script th:src="@{https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js}"></script>
  
  
</head>
<body>

<!-- ///////////////////////////////////
            BARRA NAVEGACION                  
   //////////////////////////////////// -->
	<div class="container-fluid fondoBarraNavegacion">
		<div class="row align-items-center w-100">

			<!-- Logo -->
			<div class="col-auto">
				<a class="btn-icon" th:href="@{/}"> 
					<img class="logo" th:src="@{/images/logo.png}" alt="Logo">
				</a>
			</div>

			<!-- Opciones de navegación (centradas) -->
			<div class="col text-center d-none d-md-block">
				<nav class="nav justify-content-center">
					<h2><a class="nav-link text-white" th:href="@{/manga}">MANGA</a></h2>
					<h2><a class="nav-link text-white" th:href="@{/poster}">POSTER</a></h2> 
					<h2><a class="nav-link text-white" th:href="@{/figura}">FIGURA</a></h2>
				</nav>
			</div>
			
			<!-- Icono de usuario (activador del menú) -->
			<div class="col-auto ms-auto">
				<div class="dropdown">

					<!-- Imagen de usuario autenticado -->
					<img 
						class="rounded-circle dropdown-toggle-img"
						sec:authorize="isAuthenticated()"
						th:src="@{'http://localhost:9511/usuario/foto/' + ${usuario.id}}"
						alt="Usuario" width="40" height="40"
						data-bs-toggle="dropdown"
						aria-expanded="false">
			
					<!-- Imagen por defecto para usuarios no autenticados -->
					<img 
						class="rounded-circle dropdown-toggle-img"
						sec:authorize="isAnonymous()"
						th:src="@{/images/iconoUsuario.png}"
						alt="Usuario" width="40" height="40"
						data-bs-toggle="dropdown"
						aria-expanded="false">

					<!-- Menú desplegable -->
					<ul class="dropdown-menu dropdown-menu-end"
						aria-labelledby="dropdownMenuButton">
						<li th:if="${auth != null and auth.admin}"><a
							class="dropdown-item" th:href="@{/admin}">Lista de Usuarios</a></li>
						<li><a class="dropdown-item" th:href="@{/registro}">Registro</a></li>
						<li><a class="dropdown-item" th:href="@{/login}">Login</a></li>
						<li sec:authorize="hasRole('ADMIN')" ><a class="dropdown-item" th:href="@{/admin/obtenerUsuario}">Admin</a></li>
						<li sec:authorize="hasRole('ADMIN')" ><a class="dropdown-item" th:href="@{/admin/obtenerArticulos}">Articulos</a></li>
						<li><hr class="dropdown-divider"></li>
						<li><a class="dropdown-item text-danger" th:href="@{/logout}">Logout</a></li>
					</ul>
				</div>
			</div>

		</div>
	</div>



<!-- ///////////////////////////////////
            LISTA DE USUARIOS                  
   //////////////////////////////////// -->
  <div class="container mt-3">
     <input id="filtroNombre" type="text" class="form-control" placeholder="Buscar por nombre...">
  </div>

  <div class="container mt-5">
    <table class="table table-bordered">
      <thead id="cabezeraTablaUsuarios">
        <tr>
         
          <th>Nombre</th>
          <th>Descripcion</th>
          <th>Precio</th>
          <th>Stock</th>
          <th>Tipo Articulo</th>
          <th>Imagen</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <!-- Mostrar usuarios -->
        <tr th:each="articulo : ${articulos}">
          
          <td th:text="${articulo.nombre}"></td>
          <td th:text="${articulo.descripcion}"></td>
          <td th:text="${articulo.precio}"></td>
          <td th:text="${articulo.stock}"></td>
		  <td th:text="${articulo.tipoArticulo}"></td>
          <td><img th:src="@{/images/shanksPoster.jpg}"></td>
        </tr>        
      </tbody>
    </table>
    
    
  
  </div>
  
  
  
  
  
 
 <!-- ///////////////////////////////////
                JAVASCRIPT                  
   //////////////////////////////////// -->
  	<script>	
	  	document.getElementById('filtroNombre').addEventListener('input', function() {
	  	  const texto = this.value.toLowerCase();
	  	  document.querySelectorAll('tbody tr').forEach(tr => {
	  	    const nombre = tr.children[0].textContent.toLowerCase();
	  	    tr.style.display = nombre.includes(texto) ? '' : 'none';
	  	  });
	  	});
  	</script>
</body>
</html>
